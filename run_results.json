{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.2", "generated_at": "2026-02-23T12:32:57.719321Z", "invocation_id": "1824bb9e-cd79-46f6-a927-a3271490c689", "invocation_started_at": "2026-02-23T12:32:48.228092Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.466284Z", "completed_at": "2026-02-23T12:32:57.469996Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.471778Z", "completed_at": "2026-02-23T12:32:57.471793Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.025881052017211914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_nba.stg_player_injuries", "compiled": true, "compiled_code": "\n\nWITH source_data AS (\n    SELECT * FROM `smartbetting-dados`.`nba`.`raw_player_injuries`\n),\n\ncleaned_data AS (\n    SELECT\n        player.id AS player_id,\n        player.team_id AS team_id,\n        season,\n        CAST(return_date AS DATE) AS return_date,\n        description,\n        status,\n        CURRENT_TIMESTAMP() AS loaded_at\n    FROM source_data\n)\n\nSELECT * FROM cleaned_data", "relation_name": "`smartbetting-dados`.`nba`.`stg_player_injuries`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.450527Z", "completed_at": "2026-02-23T12:32:57.471252Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.473302Z", "completed_at": "2026-02-23T12:32:57.473315Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030892372131347656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_nba.stg_active_players", "compiled": true, "compiled_code": "\n\nWITH source_data AS (\n    SELECT * FROM `smartbetting-dados`.`nba`.`raw_active_players`\n),\n\ncleaned_data AS (\n    SELECT\n        id AS player_id,\n        team.id AS team_id,\n        team.full_name AS team_name,\n        team.abbreviation AS team_abbreviation,\n        TRIM(first_name || ' ' || last_name) AS player_name,\n        CONCAT(TRIM(last_name || ', ' || first_name), ' (', team.abbreviation, ')') AS last_name_first_team,\n        TRIM(position) AS position,\n        CURRENT_TIMESTAMP() AS loaded_at\n    FROM source_data\n)\n\nSELECT * FROM cleaned_data", "relation_name": "`smartbetting-dados`.`nba`.`stg_active_players`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.462443Z", "completed_at": "2026-02-23T12:32:57.470754Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.472793Z", "completed_at": "2026-02-23T12:32:57.472803Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.031491756439208984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_nba.stg_games", "compiled": true, "compiled_code": "\n\nWITH source_data AS (\n    SELECT * FROM `smartbetting-dados`.`nba`.`raw_games`\n),\n\n-- Unnest the games array to get individual games\nunnested_games AS (\n    SELECT\n        season,\n        date,\n        total_games,\n        game\n    FROM source_data,\n    UNNEST(games) AS game\n),\n\ncleaned_data AS (\n    SELECT\n        CAST(game.id AS INT64) AS game_id,\n        CAST(season AS INT64) AS season,\n        PARSE_DATE('%Y-%m-%d', date) AS game_date,\n        --game.status AS game_status,\n        --CAST(game.period AS INT64) AS period,\n        --game.time,\n        --CAST(game.postseason AS BOOL) AS is_postseason,\n        game.datetime AS game_datetime_utc,\n        -- Convert datetime to Bras\u00edlia timezone (UTC-3)\n        -- Use PARSE_TIMESTAMP for timezone support, then convert to DATETIME\n        CASE\n            WHEN game.datetime IS NOT NULL\n            THEN DATETIME(DATETIME_ADD(PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%E*S%Ez', game.datetime), INTERVAL -3 HOUR))\n        END AS game_datetime_brasilia,\n        --game.ist_stage,\n\n        -- Home team information\n        CAST(game.home_team.id AS INT64) AS home_team_id,\n        --game.home_team.conference AS home_team_conference,\n        --game.home_team.division AS home_team_division,\n        --game.home_team.city AS home_team_city,\n        --game.home_team.name AS home_team_name,\n        game.home_team.full_name AS home_team_name,\n        game.home_team.abbreviation AS home_team_abbreviation,\n        CAST(game.home_team_score AS INT64) AS home_team_score,\n\n        -- Visitor team information\n        CAST(game.visitor_team.id AS INT64) AS visitor_team_id,\n        --game.visitor_team.conference AS visitor_team_conference,\n        --game.visitor_team.division AS visitor_team_division,\n        --game.visitor_team.city AS visitor_team_city,\n        --game.visitor_team.name AS visitor_team_name,\n        game.visitor_team.full_name AS visitor_team_name,\n        game.visitor_team.abbreviation AS visitor_team_abbreviation,\n        CAST(game.visitor_team_score AS INT64) AS visitor_team_score,\n\n        -- Quarter scores (home)\n        --CAST(game.home_q1 AS INT64) AS home_q1,\n        --CAST(game.home_q2 AS INT64) AS home_q2,\n        --CAST(game.home_q3 AS INT64) AS home_q3,\n        --CAST(game.home_q4 AS INT64) AS home_q4,\n        --CAST(game.home_ot1 AS INT64) AS home_ot1,\n        --CAST(game.home_ot2 AS INT64) AS home_ot2,\n        --CAST(game.home_ot3 AS INT64) AS home_ot3,\n        --CAST(game.home_timeouts_remaining AS INT64) AS home_timeouts_remaining,\n        --CAST(game.home_in_bonus AS BOOL) AS home_in_bonus,\n\n        -- Quarter scores (visitor)\n        --CAST(game.visitor_q1 AS INT64) AS visitor_q1,\n        --CAST(game.visitor_q2 AS INT64) AS visitor_q2,\n        --CAST(game.visitor_q3 AS INT64) AS visitor_q3,\n        --CAST(game.visitor_q4 AS INT64) AS visitor_q4,\n        --CAST(game.visitor_ot1 AS INT64) AS visitor_ot1,\n        --CAST(game.visitor_ot2 AS INT64) AS visitor_ot2,\n        --CAST(game.visitor_ot3 AS INT64) AS visitor_ot3,\n        --CAST(game.visitor_timeouts_remaining AS INT64) AS visitor_timeouts_remaining,\n        --CAST(game.visitor_in_bonus AS BOOL) AS visitor_in_bonus,\n\n        -- Calculated fields\n        CASE\n            WHEN CAST(game.home_team_score AS INT64) > CAST(game.visitor_team_score AS INT64) \n            THEN CAST(game.home_team.id AS INT64)\n            WHEN CAST(game.visitor_team_score AS INT64) > CAST(game.home_team_score AS INT64) \n            THEN CAST(game.visitor_team.id AS INT64)\n        END AS winner_team_id,\n\n        CURRENT_TIMESTAMP() AS loaded_at\n    FROM unnested_games\n)\n\nSELECT * FROM cleaned_data", "relation_name": "`smartbetting-dados`.`nba`.`stg_games`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.459116Z", "completed_at": "2026-02-23T12:32:57.472278Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.475586Z", "completed_at": "2026-02-23T12:32:57.475600Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03433537483215332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_nba.stg_game_player_stats", "compiled": true, "compiled_code": "\n\nWITH source_data AS (\n    SELECT * FROM `smartbetting-dados`.`nba`.`raw_game_player_stats`\n),\n\ncleaned_data AS (\n    SELECT\n        player.id AS player_id,\n        team.id AS team_id,\n        game.id AS game_id,\n        game.date AS game_date,\n        game.home_team_score,\n        game.home_team_id,\n        game.visitor_team_score,\n        game.visitor_team_id,\n        CAST(pts AS INTEGER) AS points,\n        CAST(min AS INTEGER) AS minutes,\n        CAST(fg3m AS INTEGER) AS threes,\n        CAST(reb AS INTEGER) AS rebounds,\n        CAST(pts AS INTEGER) + CAST(reb AS INTEGER) AS points_rebounds,\n        CAST(ast AS INTEGER) AS assists,\n        CAST(pts AS INTEGER) + CAST(ast AS INTEGER) AS points_assists,\n        CAST(reb AS INTEGER) + CAST(ast AS INTEGER) AS rebounds_assists,\n        CAST(pts AS INTEGER) + CAST(reb AS INTEGER) + CAST(ast AS INTEGER) AS points_rebounds_assists,\n        CAST(stl AS INTEGER) AS steals,\n        CAST(blk AS INTEGER) AS blocks,\n        CAST(blk AS INTEGER) + CAST(stl AS INTEGER) AS blocks_steals,\n        CAST(turnover AS INTEGER) AS turnovers,\n        CASE\n            WHEN (\n                (CAST(CAST(pts AS INTEGER) > 10 AS INT64))\n                + (CAST(CAST(reb AS INTEGER) > 10 AS INT64))\n                + (CAST(CAST(ast AS INTEGER) > 10 AS INT64))\n                + (CAST(CAST(stl AS INTEGER) > 10 AS INT64))\n                + (CAST(CAST(blk AS INTEGER) > 10 AS INT64))\n            ) >= 3 THEN 1\n            ELSE 0\n        END AS triple_double,\n        CASE\n            WHEN (\n                (CAST(CAST(pts AS INTEGER) > 10 AS INT64))\n                + (CAST(CAST(reb AS INTEGER) > 10 AS INT64))\n                + (CAST(CAST(ast AS INTEGER) > 10 AS INT64))\n                + (CAST(CAST(stl AS INTEGER) > 10 AS INT64))\n                + (CAST(CAST(blk AS INTEGER) > 10 AS INT64))\n            ) >= 2 THEN 1\n            ELSE 0\n        END AS double_double,\n        CASE\n            WHEN game.home_team_score > game.visitor_team_score THEN game.home_team_id\n            WHEN game.visitor_team_score > game.home_team_score THEN game.visitor_team_id\n        END AS winner_team_id,\n        ROW_NUMBER() OVER (PARTITION BY player.id ORDER BY game.id DESC) AS game_number\n    FROM source_data\n)\n\nSELECT\n    *,\n    /*CASE\n        WHEN winner_team_id = team_id THEN 'V'\n        WHEN winner_team_id != team_id THEN 'D'\n    END AS win_loss,*/\n    CURRENT_TIMESTAMP() AS loaded_at\nFROM cleaned_data", "relation_name": "`smartbetting-dados`.`nba`.`stg_game_player_stats`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.486951Z", "completed_at": "2026-02-23T12:32:57.497543Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.502676Z", "completed_at": "2026-02-23T12:32:57.502686Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.023412704467773438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_nba.stg_player_props", "compiled": true, "compiled_code": "\n\nWITH source_data AS (\n    SELECT * FROM `smartbetting-dados`.`nba`.`raw_player_props`\n),\n\ncleaned_data AS (\n    SELECT\n        id AS prop_id,\n        player_id,\n        game_id,\n        season,\n        vendor,\n        --prop_type,\n        -- Normalize prop_type to match stat_type format (with 'player_' prefix)\n        CASE\n            WHEN prop_type = 'assists' THEN 'player_assists'\n            WHEN prop_type = 'assists_1q' THEN 'player_assists_1q'\n            WHEN prop_type = 'assists_first3min' THEN 'player_assists_first3min'\n            WHEN prop_type = 'blocks' THEN 'player_blocks'\n            WHEN prop_type = 'double_double' THEN 'player_double_double'\n            WHEN prop_type = 'points' THEN 'player_points'\n            WHEN prop_type = 'points_1q' THEN 'player_points_1q'\n            WHEN prop_type = 'points_assists' THEN 'player_points_assists'\n            WHEN prop_type = 'points_first3min' THEN 'player_points_first3min'\n            WHEN prop_type = 'points_rebounds' THEN 'player_points_rebounds'\n            WHEN prop_type = 'points_rebounds_assists' THEN 'player_points_rebounds_assists'\n            WHEN prop_type = 'rebounds' THEN 'player_rebounds'\n            WHEN prop_type = 'rebounds_1q' THEN 'player_rebounds_1q'\n            WHEN prop_type = 'rebounds_assists' THEN 'player_rebounds_assists'\n            WHEN prop_type = 'rebounds_first3min' THEN 'player_rebounds_first3min'\n            WHEN prop_type = 'steals' THEN 'player_steals'\n            WHEN prop_type = 'threes' THEN 'player_threes'\n            WHEN prop_type = 'triple_double' THEN 'player_triple_double'\n            ELSE 'player_' || prop_type  -- Fallback: add prefix if not in mapping\n        END AS stat_type,\n        CAST(line_value AS FLOAT64) AS line_value,\n        --(CAST(market.odds AS FLOAT64) / 100) + 1 AS market_odds,\n        CURRENT_TIMESTAMP() AS loaded_at\n    FROM source_data\n    WHERE market.type = 'over_under'\n)\n\nSELECT * FROM cleaned_data", "relation_name": "`smartbetting-dados`.`nba`.`stg_player_props`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.490663Z", "completed_at": "2026-02-23T12:32:57.501455Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.503295Z", "completed_at": "2026-02-23T12:32:57.503306Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023923158645629883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_nba.stg_season_averages_general_advanced", "compiled": true, "compiled_code": "\n\nWITH source_data AS (\n    SELECT * FROM `smartbetting-dados`.`nba`.`raw_season_averages_general_advanced`\n),\n\ncleaned_data AS (\n    SELECT\n        -- Player information\n        player.id AS player_id,\n\n        --CAST(stats.poss AS INTEGER) AS possessions,\n        CAST(stats.off_rating AS FLOAT64) AS offensive_rating,\n        CAST(stats.def_rating AS FLOAT64) AS defensive_rating,\n\n        --CAST(stats.poss AS INTEGER) * CAST(stats.off_rating AS FLOAT64) AS offensive_rating_points,\n        --CAST(stats.poss AS INTEGER) * CAST(stats.def_rating AS FLOAT64) AS defensive_rating_points,\n\n        CURRENT_TIMESTAMP() AS loaded_at\n    FROM source_data\n)\n\nSELECT * FROM cleaned_data", "relation_name": "`smartbetting-dados`.`nba`.`stg_season_averages_general_advanced`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.494291Z", "completed_at": "2026-02-23T12:32:57.502207Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.504316Z", "completed_at": "2026-02-23T12:32:57.504328Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02497076988220215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_nba.stg_season_averages_general_base", "compiled": true, "compiled_code": "\n\nWITH source_data AS (\n    SELECT * FROM `smartbetting-dados`.`nba`.`raw_season_averages_general_base`\n),\n\ncleaned_data AS (\n    SELECT\n        -- Player information\n        player.id AS player_id,\n\n        -- Basic statistics\n        --CAST(stats.gp AS INTEGER) AS games_played,\n        --CAST(stats.min AS FLOAT64) AS minutes,\n        CAST(stats.pts AS FLOAT64) AS points,\n        CAST(stats.reb AS FLOAT64) AS rebounds,\n        CAST(stats.pts AS FLOAT64) + CAST(stats.reb AS FLOAT64) AS points_rebounds,\n        CAST(stats.ast AS FLOAT64) AS assists,\n        CAST(stats.pts AS FLOAT64) + CAST(stats.ast AS FLOAT64) AS points_assists,\n        CAST(stats.reb AS FLOAT64) + CAST(stats.ast AS FLOAT64) AS rebounds_assists,\n        CAST(stats.pts AS FLOAT64) + CAST(stats.reb AS FLOAT64) + CAST(stats.ast AS FLOAT64) AS points_rebounds_assists,\n        CAST(stats.stl AS FLOAT64) AS steals,\n        CAST(stats.blk AS FLOAT64) AS blocks,\n        CAST(stats.blk AS FLOAT64) + CAST(stats.stl AS FLOAT64) AS blocks_steals,\n        CAST(stats.tov AS FLOAT64) AS turnovers,\n\n        -- Shooting statistics\n        --CAST(stats.fgm AS FLOAT64) AS field_goals_made,\n        --CAST(stats.fga AS FLOAT64) AS field_goals_attempted,\n        CAST(stats.fg3m AS FLOAT64) AS three_pointers_made,\n        --CAST(stats.fg3a AS FLOAT64) AS three_pointers_attempted,\n        --CAST(stats.ftm AS FLOAT64) AS free_throws_made,\n        --CAST(stats.fta AS FLOAT64) AS free_throws_attempted,\n\n        CAST(stats.dd2 AS INTEGER) AS double_doubles,\n        CAST(stats.td3 AS INTEGER) AS triple_doubles,\n\n        CAST(stats.age AS INTEGER) AS age,\n        -- Metadata\n        CURRENT_TIMESTAMP() AS loaded_at\n    FROM source_data\n)\n\nSELECT * FROM cleaned_data", "relation_name": "`smartbetting-dados`.`nba`.`stg_season_averages_general_base`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.498248Z", "completed_at": "2026-02-23T12:32:57.503783Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.508279Z", "completed_at": "2026-02-23T12:32:57.508289Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.026041030883789062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_nba.stg_season_averages_shooting_by_zone", "compiled": true, "compiled_code": "\n\nWITH source_data AS (\n    SELECT * FROM `smartbetting-dados`.`nba`.`raw_season_averages_shooting_by_zone`\n),\n\ncleaned_data AS (\n    SELECT\n        -- Player information\n        player.id AS player_id,\n        TRIM(player.first_name || ' ' || player.last_name) AS player_name,\n\n        -- Corner 3-point statistics\n        CAST(stats.corner_3_fga AS FLOAT64) AS corner_3_fga,\n        CAST(stats.corner_3_fgm AS FLOAT64) AS corner_3_fgm,\n        CAST(stats.corner_3_fg_pct AS FLOAT64) AS corner_3_fg_pct,\n        CAST(stats.left_corner_3_fga AS FLOAT64) AS left_corner_3_fga,\n        CAST(stats.left_corner_3_fgm AS FLOAT64) AS left_corner_3_fgm,\n        CAST(stats.left_corner_3_fg_pct AS FLOAT64) AS left_corner_3_fg_pct,\n        CAST(stats.right_corner_3_fga AS FLOAT64) AS right_corner_3_fga,\n        CAST(stats.right_corner_3_fgm AS FLOAT64) AS right_corner_3_fgm,\n        CAST(stats.right_corner_3_fg_pct AS FLOAT64) AS right_corner_3_fg_pct,\n\n        -- Above the break 3-point statistics\n        CAST(stats.above_the_break_3_fga AS FLOAT64) AS above_the_break_3_fga,\n        CAST(stats.above_the_break_3_fgm AS FLOAT64) AS above_the_break_3_fgm,\n        CAST(stats.above_the_break_3_fg_pct AS FLOAT64) AS above_the_break_3_fg_pct,\n\n        -- Restricted area statistics\n        CAST(stats.restricted_area_fga AS FLOAT64) AS restricted_area_fga,\n        CAST(stats.restricted_area_fgm AS FLOAT64) AS restricted_area_fgm,\n        CAST(stats.restricted_area_fg_pct AS FLOAT64) AS restricted_area_fg_pct,\n\n        -- In the paint (non-restricted area) statistics\n        CAST(stats.in_the_paint_non_ra_fga AS FLOAT64) AS in_the_paint_non_ra_fga,\n        CAST(stats.in_the_paint_non_ra_fgm AS FLOAT64) AS in_the_paint_non_ra_fgm,\n        CAST(stats.in_the_paint_non_ra_fg_pct AS FLOAT64) AS in_the_paint_non_ra_fg_pct,\n\n        -- Mid-range statistics\n        CAST(stats.mid_range_fga AS FLOAT64) AS mid_range_fga,\n        CAST(stats.mid_range_fgm AS FLOAT64) AS mid_range_fgm,\n        CAST(stats.mid_range_fg_pct AS FLOAT64) AS mid_range_fg_pct,\n\n        -- Backcourt statistics\n        CAST(stats.backcourt_fga AS FLOAT64) AS backcourt_fga,\n        CAST(stats.backcourt_fgm AS FLOAT64) AS backcourt_fgm,\n        CAST(stats.backcourt_fg_pct AS FLOAT64) AS backcourt_fg_pct,\n\n        -- Metadata\n        CURRENT_TIMESTAMP() AS loaded_at\n    FROM source_data\n)\n\nSELECT * FROM cleaned_data", "relation_name": "`smartbetting-dados`.`nba`.`stg_season_averages_shooting_by_zone`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.517474Z", "completed_at": "2026-02-23T12:32:57.533799Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.537863Z", "completed_at": "2026-02-23T12:32:57.537877Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02788543701171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_nba.stg_team_season_averages_general_advanced", "compiled": true, "compiled_code": "\n\nWITH source_data AS (\n    SELECT * FROM `smartbetting-dados`.`nba`.`raw_team_season_averages_general_advanced`\n),\n\ncleaned_data AS (\n    SELECT\n        CAST(team.id AS INT64) AS team_id,\n        CAST(season AS INT64) AS season,\n        season_type,\n        CAST(stats.off_rating AS FLOAT64) AS team_offensive_rating,\n        CAST(stats.def_rating AS FLOAT64) AS team_defensive_rating,\n        COALESCE(\n            SAFE_CAST(stats.net_rating AS FLOAT64),\n            CAST(stats.off_rating AS FLOAT64) - CAST(stats.def_rating AS FLOAT64)\n        ) AS team_net_rating,\n        SAFE_CAST(stats.poss AS FLOAT64) AS team_possessions,\n        SAFE_CAST(stats.pace AS FLOAT64) AS team_pace,\n        CURRENT_TIMESTAMP() AS loaded_at\n    FROM source_data\n)\n\nSELECT * FROM cleaned_data", "relation_name": "`smartbetting-dados`.`nba`.`stg_team_season_averages_general_advanced`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.521007Z", "completed_at": "2026-02-23T12:32:57.537252Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.538982Z", "completed_at": "2026-02-23T12:32:57.538991Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029433250427246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_nba.stg_team_standings", "compiled": true, "compiled_code": "\n\nWITH source_data AS (\n    SELECT * FROM `smartbetting-dados`.`nba`.`raw_team_standings`\n),\n\ncleaned_data AS (\n    SELECT\n        team.id AS team_id,\n        team.full_name AS team_name,\n        team.abbreviation AS team_abbreviation,\n        team.conference,\n        team.city AS team_city,\n        season,\n        conference_rank,\n        CAST(wins AS INT64) AS wins,\n        CAST(losses AS INT64) AS losses,\n        \n        -- Calculate if current date is in DST period (second Sunday of March to first Sunday of November)\n        -- DST: During DST, US cities advance 1 hour (except Arizona/Phoenix)\n        CASE\n            WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE  -- April to October\n            WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN  -- March: check if after second Sunday\n                CASE\n                    WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                    ELSE FALSE\n                END\n            WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN  -- November: check if before first Sunday\n                CASE\n                    WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                    ELSE FALSE\n                END\n            ELSE FALSE\n        END AS is_dst,\n        \n        -- Calculate injury report time offset (hours to add to 13:30 local to get Bras\u00edlia time)\n        -- Injury report releases at 13:30 local time\n        CASE team.city\n            -- Pacific Time (PT): -8 UTC standard, -7 UTC DST | Brasil -3 UTC\n            WHEN 'Los Angeles' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 4 ELSE 5 END\n            WHEN 'LA' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 4 ELSE 5 END\n            WHEN 'Golden State' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 4 ELSE 5 END\n            WHEN 'Portland' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 4 ELSE 5 END\n            WHEN 'Sacramento' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 4 ELSE 5 END\n            \n            -- Mountain Time (MT): -7 UTC standard, -6 UTC DST | Brasil -3 UTC\n            WHEN 'Denver' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 3 ELSE 4 END\n            WHEN 'Utah' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 3 ELSE 4 END\n            WHEN 'Oklahoma City' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 3 ELSE 4 END\n            \n            -- Mountain Time - No DST (Arizona): Always -7 UTC | Brasil -3 UTC\n            WHEN 'Phoenix' THEN 4  -- Arizona does not observe DST\n            \n            -- Central Time (CT): -6 UTC standard, -5 UTC DST | Brasil -3 UTC\n            WHEN 'Chicago' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 2 ELSE 3 END\n            WHEN 'Dallas' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 2 ELSE 3 END\n            WHEN 'Houston' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 2 ELSE 3 END\n            WHEN 'Memphis' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 2 ELSE 3 END\n            WHEN 'Minnesota' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 2 ELSE 3 END\n            WHEN 'Milwaukee' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 2 ELSE 3 END\n            WHEN 'New Orleans' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 2 ELSE 3 END\n            WHEN 'San Antonio' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 2 ELSE 3 END\n            \n            -- Eastern Time (ET): -5 UTC standard, -4 UTC DST | Brasil -3 UTC\n            WHEN 'Atlanta' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 1 ELSE 2 END\n            WHEN 'Boston' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 1 ELSE 2 END\n            WHEN 'Brooklyn' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 1 ELSE 2 END\n            WHEN 'Charlotte' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 1 ELSE 2 END\n            WHEN 'Cleveland' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 1 ELSE 2 END\n            WHEN 'Detroit' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 1 ELSE 2 END\n            WHEN 'Indiana' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 1 ELSE 2 END\n            WHEN 'Miami' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 1 ELSE 2 END\n            WHEN 'New York' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 1 ELSE 2 END\n            WHEN 'Orlando' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 1 ELSE 2 END\n            WHEN 'Philadelphia' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 1 ELSE 2 END\n            WHEN 'Toronto' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 1 ELSE 2 END\n            WHEN 'Washington' THEN CASE WHEN (\n                CASE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                        CASE\n                            WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                            ELSE FALSE\n                        END\n                    ELSE FALSE\n                END\n            ) THEN 1 ELSE 2 END\n        END AS injury_report_time_offset_hours,\n        \n        -- Calculate injury report time in Bras\u00edlia timezone (13:30 local + offset) as STRING\n        FORMAT_TIME('%H:%M:%S', TIME_ADD(TIME(13, 0, 0), INTERVAL \n            CASE team.city\n                -- Pacific Time (PT): -8 UTC standard, -7 UTC DST | Brasil -3 UTC\n                WHEN 'Los Angeles' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 4 ELSE 5 END\n                WHEN 'LA' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 4 ELSE 5 END\n                WHEN 'Golden State' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 4 ELSE 5 END\n                WHEN 'Portland' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 4 ELSE 5 END\n                WHEN 'Sacramento' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 4 ELSE 5 END\n                \n                -- Mountain Time (MT): -7 UTC standard, -6 UTC DST | Brasil -3 UTC\n                WHEN 'Denver' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 3 ELSE 4 END\n                WHEN 'Utah' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 3 ELSE 4 END\n                WHEN 'Oklahoma City' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 3 ELSE 4 END\n                \n                -- Mountain Time - No DST (Arizona): Always -7 UTC | Brasil -3 UTC\n                WHEN 'Phoenix' THEN 4  -- Arizona does not observe DST\n                \n                -- Central Time (CT): -6 UTC standard, -5 UTC DST | Brasil -3 UTC\n                WHEN 'Chicago' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 2 ELSE 3 END\n                WHEN 'Dallas' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 2 ELSE 3 END\n                WHEN 'Houston' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 2 ELSE 3 END\n                WHEN 'Memphis' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 2 ELSE 3 END\n                WHEN 'Minnesota' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 2 ELSE 3 END\n                WHEN 'Milwaukee' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 2 ELSE 3 END\n                WHEN 'New Orleans' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 2 ELSE 3 END\n                WHEN 'San Antonio' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 2 ELSE 3 END\n                \n                -- Eastern Time (ET): -5 UTC standard, -4 UTC DST | Brasil -3 UTC\n                WHEN 'Atlanta' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 1 ELSE 2 END\n                WHEN 'Boston' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 1 ELSE 2 END\n                WHEN 'Brooklyn' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 1 ELSE 2 END\n                WHEN 'Charlotte' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 1 ELSE 2 END\n                WHEN 'Cleveland' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 1 ELSE 2 END\n                WHEN 'Detroit' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 1 ELSE 2 END\n                WHEN 'Indiana' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 1 ELSE 2 END\n                WHEN 'Miami' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 1 ELSE 2 END\n                WHEN 'New York' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 1 ELSE 2 END\n                WHEN 'Orlando' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 1 ELSE 2 END\n                WHEN 'Philadelphia' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 1 ELSE 2 END\n                WHEN 'Toronto' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 1 ELSE 2 END\n                WHEN 'Washington' THEN CASE WHEN (\n                    CASE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) BETWEEN 4 AND 10 THEN TRUE\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 3 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) >= (8 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 3, 8)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        WHEN EXTRACT(MONTH FROM CURRENT_DATE()) = 11 THEN\n                            CASE\n                                WHEN EXTRACT(DAY FROM CURRENT_DATE()) < (1 + (7 - EXTRACT(DAYOFWEEK FROM DATE(EXTRACT(YEAR FROM CURRENT_DATE()), 11, 1)))) THEN TRUE\n                                ELSE FALSE\n                            END\n                        ELSE FALSE\n                    END\n                ) THEN 1 ELSE 2 END\n            END \n        HOUR)) AS team_injury_report_time_brasilia,\n        \n        CURRENT_TIMESTAMP() AS loaded_at\n    FROM source_data\n)\n\nSELECT * FROM cleaned_data", "relation_name": "`smartbetting-dados`.`nba`.`stg_team_standings`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.534444Z", "completed_at": "2026-02-23T12:32:57.539522Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.542296Z", "completed_at": "2026-02-23T12:32:57.542308Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02907872200012207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_nba.int_game_player_stats_last_game_text", "compiled": true, "compiled_code": "\n\nWITH last_games_text AS (\n    SELECT\n        player_id,\n        MAX(game_date) AS last_game_date\n    FROM\n        `smartbetting-dados`.`nba`.`stg_game_player_stats`\n    WHERE\n        minutes > 0\n    GROUP BY\n        player_id\n),\n\nlast_game_text AS (\n    SELECT\n        player_id,\n        CONCAT(\n            'Ultimo Jogo: ',\n            CAST(DATE_DIFF(CURRENT_DATE(), last_game_date, DAY) AS STRING),\n            ' ',\n            CASE\n                WHEN DATE_DIFF(CURRENT_DATE(), last_game_date, DAY) = 1 THEN 'dia atras'\n                ELSE 'dias atras'\n            END\n        ) AS last_game_text,\n        CURRENT_TIMESTAMP() AS loaded_at\n    FROM\n        last_games_text\n)\n\nSELECT * FROM last_game_text", "relation_name": "`smartbetting-dados`.`nba`.`int_game_player_stats_last_game_text`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.530578Z", "completed_at": "2026-02-23T12:32:57.538417Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.541683Z", "completed_at": "2026-02-23T12:32:57.541695Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.031621456146240234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_nba.int_games_teams_pilled", "compiled": true, "compiled_code": "\n\nWITH base_data AS (\n    SELECT \n        *,\n        -- Ensure game_date is DATE type (safety conversion - handles both DATE and STRING)\n        COALESCE(\n            SAFE_CAST(game_date AS DATE),\n            PARSE_DATE('%Y-%m-%d', CAST(game_date AS STRING))\n        ) AS game_date_typed\n    FROM `smartbetting-dados`.`nba`.`stg_games`\n),\n\n-- Create all team games to identify B2B patterns and next games\nall_team_games AS (\n    -- Home team games\n    SELECT\n        game_id,\n        game_date_typed AS game_date,\n        --game_status,\n        home_team_id AS team_id,\n        home_team_abbreviation AS team_abbreviation,\n        home_team_name AS team_name,\n        home_team_score AS team_score,\n        CASE\n            WHEN winner_team_id = home_team_id THEN 'V'\n            WHEN winner_team_id = visitor_team_id THEN 'D'\n        END AS win_loss,\n        home_team_id,\n        home_team_abbreviation,\n        home_team_name,\n        visitor_team_id,\n        visitor_team_abbreviation,\n        visitor_team_name\n    FROM base_data\n\n    UNION ALL\n\n    -- Visitor team games\n    SELECT\n        game_id,\n        game_date_typed AS game_date,\n        --game_status,\n        visitor_team_id AS team_id,\n        visitor_team_abbreviation AS team_abbreviation,\n        visitor_team_name AS team_name,\n        visitor_team_score AS team_score,\n        CASE\n            WHEN winner_team_id = visitor_team_id THEN 'V'\n            WHEN winner_team_id = home_team_id THEN 'D'\n        END AS win_loss,\n        home_team_id,\n        home_team_abbreviation,\n        home_team_name,\n        visitor_team_id,\n        visitor_team_abbreviation,\n        visitor_team_name\n    FROM base_data\n),\n\n-- Identify consecutive games for each team (only for games before 2025-04-07 for B2B analysis)\nconsecutive_games AS (\n    SELECT\n        game_id,\n        team_id,\n        LAG(game_date) OVER (PARTITION BY team_id ORDER BY game_date, game_id) AS previous_game_date,\n        DATE_DIFF(game_date, LAG(game_date) OVER (PARTITION BY team_id ORDER BY game_date, game_id), DAY)\n            AS days_between_games\n    FROM all_team_games\n),\n\n-- Identify B2B games\nb2b_games AS (\n    SELECT DISTINCT\n        game_id,\n        team_id,\n        true AS is_b2b_game\n    FROM consecutive_games\n    WHERE\n        days_between_games = 1\n        AND previous_game_date IS NOT null  -- Ensure there's a previous game\n),\n\n-- Identify next game for each team (starting from 2025-04-07)\nnext_games AS (\n    SELECT DISTINCT\n        game_id,\n        team_id,\n        true AS is_next_game\n    FROM all_team_games\n    WHERE\n        game_date >= CURRENT_DATE()\n        AND game_id IN (\n            -- Get the first game for each team on or after 2025-04-07\n            SELECT\n                FIRST_VALUE(game_id) OVER (\n                    PARTITION BY team_id\n                    ORDER BY game_date ASC, game_id ASC\n                ) AS first_game_id\n            FROM all_team_games\n            WHERE game_date >= CURRENT_DATE()\n        )\n),\n\n-- Final result with B2B and next game flags\n\nlast_five_games AS (\n    SELECT\n        team_id,\n        STRING_AGG(win_loss, ' ' ORDER BY game_date DESC, game_id DESC) AS team_last_five_games\n    FROM (\n        SELECT\n            team_id,\n            game_id,\n            game_date,\n            win_loss,\n            ROW_NUMBER() OVER (PARTITION BY team_id ORDER BY game_date DESC, game_id DESC) AS row_num\n        FROM all_team_games\n        WHERE \n            win_loss IS NOT NULL  -- Only completed games\n            AND game_date < CURRENT_DATE()  -- Only past games\n    )\n    WHERE row_num <= 5\n    GROUP BY team_id\n),\n\nfinal_result AS (\n    SELECT\n        atg.*,\n        lfg.team_last_five_games,\n        COALESCE(bb.is_b2b_game, false) AS is_b2b_game,\n        COALESCE(ng.is_next_game, false) AS is_next_game,\n        CURRENT_TIMESTAMP() AS loaded_at\n    FROM all_team_games AS atg\n    LEFT JOIN b2b_games AS bb ON atg.game_id = bb.game_id AND atg.team_id = bb.team_id\n    LEFT JOIN next_games AS ng ON atg.game_id = ng.game_id AND atg.team_id = ng.team_id\n    LEFT JOIN last_five_games AS lfg ON atg.team_id = lfg.team_id\n)\n\nSELECT * FROM final_result", "relation_name": "`smartbetting-dados`.`nba`.`int_games_teams_pilled`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.553041Z", "completed_at": "2026-02-23T12:32:57.563464Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.567418Z", "completed_at": "2026-02-23T12:32:57.567430Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02134990692138672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_nba.int_game_player_stats_not_played", "compiled": true, "compiled_code": "\n\nWITH\n\ninjury_games AS (\n    SELECT DISTINCT\n        player_id,\n        team_id,\n        game_id\n    FROM `smartbetting-dados`.`nba`.`stg_game_player_stats`\n    WHERE minutes = 0\n)\n\nSELECT * FROM injury_games", "relation_name": "`smartbetting-dados`.`nba`.`int_game_player_stats_not_played`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.556970Z", "completed_at": "2026-02-23T12:32:57.567980Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.570808Z", "completed_at": "2026-02-23T12:32:57.570818Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023469209671020508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_nba.int_game_player_stats_pilled", "compiled": true, "compiled_code": "\n\nWITH base_data AS (\n    SELECT * FROM `smartbetting-dados`.`nba`.`stg_game_player_stats`\n    WHERE\n        minutes > 0\n),\n\n-- Pilled the specified stats\nstats_pilled AS (\n    SELECT\n        player_id,\n        team_id,\n        game_id,\n        game_number,\n        game_date,\n        'player_points' AS stat_type,\n        CAST(points AS FLOAT64) AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        team_id,\n        game_id,\n        game_number,\n        game_date,\n        'player_threes' AS stat_type,\n        CAST(threes AS FLOAT64) AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        team_id,\n        game_id,\n        game_number,\n        game_date,\n        'player_rebounds' AS stat_type,\n        CAST(rebounds AS FLOAT64) AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        team_id,\n        game_id,\n        game_number,\n        game_date,\n        'player_assists' AS stat_type,\n        CAST(assists AS FLOAT64) AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        team_id,\n        game_id,\n        game_number,\n        game_date,\n        'player_blocks' AS stat_type,\n        CAST(blocks AS FLOAT64) AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        team_id,\n        game_id,\n        game_number,\n        game_date,\n        'player_steals' AS stat_type,\n        CAST(steals AS FLOAT64) AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        team_id,\n        game_id,\n        game_number,\n        game_date,\n        'player_turnovers' AS stat_type,\n        CAST(turnovers AS FLOAT64) AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        team_id,\n        game_id,\n        game_number,\n        game_date,\n        'player_points_rebounds' AS stat_type,\n        CAST(points_rebounds AS FLOAT64) AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        team_id,\n        game_id,\n        game_number,\n        game_date,\n        'player_points_assists' AS stat_type,\n        CAST(points_assists AS FLOAT64) AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        team_id,\n        game_id,\n        game_number,\n        game_date,\n        'player_rebounds_assists' AS stat_type,\n        CAST(rebounds_assists AS FLOAT64) AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        team_id,\n        game_id,\n        game_number,\n        game_date,\n        'player_points_rebounds_assists' AS stat_type,\n        CAST(points_rebounds_assists AS FLOAT64) AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        team_id,\n        game_id,\n        game_number,\n        game_date,\n        'player_blocks_steals' AS stat_type,\n        CAST(blocks_steals AS FLOAT64) AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        team_id,\n        game_id,\n        game_number,\n        game_date,\n        'player_double_double' AS stat_type,\n        CAST(double_double AS FLOAT64) AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        team_id,\n        game_id,\n        game_number,\n        game_date,\n        'player_triple_double' AS stat_type,\n        CAST(triple_double AS FLOAT64) AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        team_id,\n        game_id,\n        game_number,\n        game_date,\n        'player_minutes' AS stat_type,\n        CAST(minutes AS FLOAT64) AS stat_value\n    FROM base_data\n)\n\nSELECT\n    player_id,\n    team_id,\n    game_id,\n    game_number,\n    game_date,\n    stat_type,\n    stat_value,\n    CURRENT_TIMESTAMP() AS loaded_at\nFROM stats_pilled", "relation_name": "`smartbetting-dados`.`nba`.`int_game_player_stats_pilled`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.560245Z", "completed_at": "2026-02-23T12:32:57.568640Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.571810Z", "completed_at": "2026-02-23T12:32:57.571822Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.025066137313842773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_nba.int_season_averages_general_base", "compiled": true, "compiled_code": "\n\nWITH base_data AS (\n    SELECT * FROM `smartbetting-dados`.`nba`.`stg_season_averages_general_base`\n),\n\n-- Unpivot the specified stats into long format\nstats_unpivoted AS (\n    SELECT\n        player_id,\n        'player_points' AS stat_type,\n        points AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        'player_rebounds' AS stat_type,\n        rebounds AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        'player_assists' AS stat_type,\n        assists AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        'player_steals' AS stat_type,\n        steals AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        'player_blocks' AS stat_type,\n        blocks AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        'player_turnovers' AS stat_type,\n        turnovers AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        'player_threes' AS stat_type,\n        three_pointers_made AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        'player_points_rebounds' AS stat_type,\n        points_rebounds AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        'player_points_assists' AS stat_type,\n        points_assists AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        'player_rebounds_assists' AS stat_type,\n        rebounds_assists AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        'player_points_rebounds_assists' AS stat_type,\n        points_rebounds_assists AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        'player_blocks_steals' AS stat_type,\n        blocks_steals AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        'player_double_double' AS stat_type,\n        CAST(double_doubles AS FLOAT64) AS stat_value\n    FROM base_data\n\n    UNION ALL\n\n    SELECT\n        player_id,\n        'player_triple_double' AS stat_type,\n        CAST(triple_doubles AS FLOAT64) AS stat_value\n    FROM base_data\n)\n\nSELECT *\nFROM stats_unpivoted", "relation_name": "`smartbetting-dados`.`nba`.`int_season_averages_general_base`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.563966Z", "completed_at": "2026-02-23T12:32:57.571328Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.574664Z", "completed_at": "2026-02-23T12:32:57.574673Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.027290821075439453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_nba.dim_player_shooting_by_zones", "compiled": true, "compiled_code": "\n\nWITH dim_player_shooting_by_zones AS (\n\n    SELECT\n       *\n    FROM `smartbetting-dados`.`nba`.`stg_season_averages_shooting_by_zone`\n)\n\nSELECT * FROM dim_player_shooting_by_zones", "relation_name": "`smartbetting-dados`.`nba`.`dim_player_shooting_by_zones`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.581145Z", "completed_at": "2026-02-23T12:32:57.587809Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.598359Z", "completed_at": "2026-02-23T12:32:57.598368Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02975296974182129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_nba.dim_players", "compiled": true, "compiled_code": "\n\nWITH dim_players AS (\n\n    SELECT\n        p.player_id,\n        p.player_name,\n        p.position,\n        p.team_id,\n        p.team_name,\n        p.team_abbreviation,\n        s.age,\n        g.last_game_text,\n        ir.status,\n        ir.description,\n        ir.return_date,\n        CURRENT_TIMESTAMP() AS loaded_at\n    FROM\n        `smartbetting-dados`.`nba`.`stg_active_players` AS p\n    LEFT JOIN\n        `smartbetting-dados`.`nba`.`stg_season_averages_general_base` AS s\n        ON p.player_id = s.player_id\n    LEFT JOIN `smartbetting-dados`.`nba`.`int_game_player_stats_last_game_text` AS g ON p.player_id = g.player_id\n    LEFT JOIN `smartbetting-dados`.`nba`.`stg_player_injuries` AS ir\n        ON p.player_id = ir.player_id\n)\n\nSELECT * FROM dim_players", "relation_name": "`smartbetting-dados`.`nba`.`dim_players`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.588321Z", "completed_at": "2026-02-23T12:32:57.603500Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.606770Z", "completed_at": "2026-02-23T12:32:57.606779Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02986621856689453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_nba.dim_teams", "compiled": true, "compiled_code": "\n\nWITH team_rating AS (\n    SELECT\n        team_id,\n        season,\n        team_offensive_rating,\n        team_defensive_rating,\n        team_net_rating,\n        ROW_NUMBER() OVER (PARTITION BY season ORDER BY team_net_rating DESC) AS team_rating_rank,\n        ROW_NUMBER() OVER (PARTITION BY season ORDER BY team_offensive_rating DESC) AS team_offensive_rating_rank,\n        ROW_NUMBER() OVER (PARTITION BY season ORDER BY team_defensive_rating ASC) AS team_defensive_rating_rank\n    FROM `smartbetting-dados`.`nba`.`stg_team_season_averages_general_advanced`\n    WHERE season_type = 'regular'\n),\n\n-- Aggregate team last five games (one row per team)\nteam_last_five AS (\n    SELECT\n        team_id,\n        ANY_VALUE(team_last_five_games) AS team_last_five_games\n    FROM `smartbetting-dados`.`nba`.`int_games_teams_pilled`\n    GROUP BY team_id\n),\n\n-- Get next game for each team (one row per team - the closest future game)\nnext_game_info AS (\n    SELECT\n        team_id,\n        home_team_id,\n        home_team_name,\n        home_team_abbreviation,\n        visitor_team_id,\n        visitor_team_name,\n        visitor_team_abbreviation,\n        -- Determine if next game is at home\n        CASE \n            WHEN team_id = home_team_id THEN TRUE\n            ELSE FALSE\n        END AS is_next_game_home\n    FROM `smartbetting-dados`.`nba`.`int_games_teams_pilled`\n    WHERE is_next_game = true\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY team_id ORDER BY game_date ASC, game_id ASC) = 1\n),\n\n-- Calculate next opponent info (one row per team)\nnext_opponent_info AS (\n    SELECT\n        ngi.team_id,\n        ngi.is_next_game_home,\n        CASE\n            WHEN ngi.team_id = ngi.home_team_id THEN ngi.visitor_team_id\n            WHEN ngi.team_id = ngi.visitor_team_id THEN ngi.home_team_id\n        END AS next_opponent_id,\n        CASE\n            WHEN ngi.team_id = ngi.home_team_id THEN ngi.visitor_team_name\n            WHEN ngi.team_id = ngi.visitor_team_id THEN ngi.home_team_name\n        END AS next_opponent_name,\n        CASE\n            WHEN ngi.team_id = ngi.home_team_id THEN ngi.visitor_team_abbreviation\n            WHEN ngi.team_id = ngi.visitor_team_id THEN ngi.home_team_abbreviation\n        END AS next_opponent_abbreviation\n    FROM next_game_info AS ngi\n),\n\ndim_teams AS (\n    SELECT\n        t.team_id,\n        t.team_name,\n        t.team_abbreviation,\n        t.conference,\n        t.team_city,\n        t.season,\n        t.conference_rank,\n        t.wins,\n        t.losses,\n        tlf.team_last_five_games,\n        tr.team_offensive_rating,\n        tr.team_defensive_rating,\n        tr.team_net_rating,\n        tr.team_rating_rank,\n        tr.team_offensive_rating_rank,\n        tr.team_defensive_rating_rank,\n        noi.next_opponent_id,\n        noi.next_opponent_name,\n        noi.next_opponent_abbreviation,\n        noi.is_next_game_home,\n        tlf_opp.team_last_five_games AS next_opponent_team_last_five_games,\n        ts_opp.conference_rank AS next_opponent_conference_rank,\n        tr_opp.team_offensive_rating AS next_opponent_team_offensive_rating,\n        tr_opp.team_defensive_rating AS next_opponent_team_defensive_rating,\n        tr_opp.team_net_rating AS next_opponent_team_net_rating,\n        tr_opp.team_rating_rank AS next_opponent_team_rating_rank,\n        tr_opp.team_offensive_rating_rank AS next_opponent_team_offensive_rating_rank,\n        tr_opp.team_defensive_rating_rank AS next_opponent_team_defensive_rating_rank,\n        \n        -- Injury report time for the team's home city (STRING type, from staging)\n        t.team_injury_report_time_brasilia,\n        \n        -- Injury report time for the next game (STRING type, based on where the game is played)\n        CASE \n            WHEN noi.is_next_game_home THEN t.team_injury_report_time_brasilia\n            ELSE ts_opp.team_injury_report_time_brasilia\n        END AS next_game_injury_report_time_brasilia,\n        \n        CURRENT_TIMESTAMP() AS loaded_at\n    FROM `smartbetting-dados`.`nba`.`stg_team_standings` AS t\n    LEFT JOIN team_last_five AS tlf ON t.team_id = tlf.team_id\n    LEFT JOIN team_rating AS tr ON t.team_id = tr.team_id AND t.season = tr.season\n    LEFT JOIN next_opponent_info AS noi ON t.team_id = noi.team_id\n    -- Next opponent data\n    LEFT JOIN team_last_five AS tlf_opp ON noi.next_opponent_id = tlf_opp.team_id\n    LEFT JOIN `smartbetting-dados`.`nba`.`stg_team_standings` AS ts_opp ON noi.next_opponent_id = ts_opp.team_id\n    LEFT JOIN team_rating AS tr_opp ON noi.next_opponent_id = tr_opp.team_id AND t.season = tr_opp.season\n)\n\nSELECT * FROM dim_teams", "relation_name": "`smartbetting-dados`.`nba`.`dim_teams`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.598982Z", "completed_at": "2026-02-23T12:32:57.605787Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.607922Z", "completed_at": "2026-02-23T12:32:57.607931Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02543473243713379, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_nba.ft_game_player_stats", "compiled": true, "compiled_code": "\nWITH most_recent_line_value AS (\n    SELECT\n        p.player_id,\n        p.stat_type,\n        p.line_value AS line_value_most_recent\n    FROM `smartbetting-dados`.`nba`.`stg_player_props` p\n    LEFT JOIN `smartbetting-dados`.`nba`.`stg_games` g\n    ON g.game_id = p.game_id\n    QUALIFY\n        ROW_NUMBER()\n            OVER (PARTITION BY p.player_id, p.stat_type ORDER BY g.game_date DESC)\n    = 1\n)\nSELECT\n    gps.player_id,\n    gps.game_date,\n    gps.game_id,\n    gps.stat_type,\n    gps.stat_value,\n    o.line_value,\n    mrlv.line_value_most_recent,\n    gt.is_b2b_game,\n    CASE\n        WHEN o.line_value IS null THEN null\n        WHEN gps.stat_value >= o.line_value THEN 'over'\n        WHEN gps.stat_value < o.line_value THEN 'under'\n    END AS stat_vs_line,\n    CASE\n        WHEN gps.team_id = gt.home_team_id THEN gt.visitor_team_abbreviation\n        WHEN gps.team_id = gt.visitor_team_id THEN '@' || gt.home_team_abbreviation\n    END AS played_against,\n    CASE\n        WHEN gps.team_id = gt.home_team_id THEN 'Casa'\n        WHEN gps.team_id = gt.visitor_team_id THEN 'Fora'\n    END AS home_away,\n    CASE\n        WHEN not_played.player_id IS NOT null THEN 'N\u00e3o jogou'\n        ELSE 'Jogou'\n    END AS is_played\nFROM\n    `smartbetting-dados`.`nba`.`int_game_player_stats_pilled` AS gps\nLEFT JOIN\n    `smartbetting-dados`.`nba`.`int_games_teams_pilled` AS gt\n    ON gps.game_id = gt.game_id AND gps.team_id = gt.team_id AND gt.game_date <= CURRENT_DATE()\nLEFT JOIN `smartbetting-dados`.`nba`.`stg_player_props` AS o ON gps.player_id = o.player_id \n    AND gps.game_id = o.game_id \n    AND o.stat_type = gps.stat_type\nLEFT JOIN\n    `smartbetting-dados`.`nba`.`int_game_player_stats_not_played` AS not_played\n    ON gps.player_id = not_played.player_id AND gps.game_id = not_played.game_id AND gps.team_id = not_played.team_id\nLEFT JOIN\n    most_recent_line_value AS mrlv\n    ON gps.player_id = mrlv.player_id AND gps.stat_type = mrlv.stat_type\nORDER BY\n    player_id,\n    game_id", "relation_name": "`smartbetting-dados`.`nba`.`ft_game_player_stats`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.594574Z", "completed_at": "2026-02-23T12:32:57.606294Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.608429Z", "completed_at": "2026-02-23T12:32:57.608438Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.028110265731811523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_nba.ft_games", "compiled": true, "compiled_code": "\n\nSELECT g.*,\n    gth.is_b2b_game AS home_team_is_b2b_game,\n    gtv.is_b2b_game AS visitor_team_is_b2b_game,\n    gth.is_next_game AS home_team_is_next_game,\n    gtv.is_next_game AS visitor_team_is_next_game,\nFROM `smartbetting-dados`.`nba`.`stg_games` g\nLEFT JOIN `smartbetting-dados`.`nba`.`int_games_teams_pilled` gth ON g.game_id = gth.game_id AND g.home_team_id = gth.team_id\nLEFT JOIN `smartbetting-dados`.`nba`.`int_games_teams_pilled` gtv ON g.game_id = gtv.game_id AND g.visitor_team_id = gtv.team_id", "relation_name": "`smartbetting-dados`.`nba`.`ft_games`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.616854Z", "completed_at": "2026-02-23T12:32:57.624386Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.630998Z", "completed_at": "2026-02-23T12:32:57.631009Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03679060935974121, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_nba.dim_stat_player", "compiled": true, "compiled_code": "\n\nWITH\n\n-- Performance of backup players when specific leaders are injured\nbackup_performance_when_leader_injured AS (\n    SELECT\n        ipr.player_id AS injured_leader_id,\n        ipr.team_id,\n        gps.stat_type,\n        backup_player.player_id AS backup_player_id,\n        AVG(backup_player.stat_value) AS backup_stats_when_leader_out\n    FROM `smartbetting-dados`.`nba`.`int_game_player_stats_not_played` AS ipr\n    INNER JOIN `smartbetting-dados`.`nba`.`int_game_player_stats_pilled` AS gps\n        ON\n            ipr.player_id = gps.player_id\n            AND ipr.team_id = gps.team_id\n    INNER JOIN `smartbetting-dados`.`nba`.`int_game_player_stats_pilled` AS backup_player\n        ON\n            ipr.team_id = backup_player.team_id\n            AND gps.game_id = backup_player.game_id\n            AND gps.stat_type = backup_player.stat_type\n            AND ipr.player_id != backup_player.player_id\n    GROUP BY\n        ipr.player_id,\n        ipr.team_id,\n        gps.stat_type,\n        backup_player.player_id\n),\n\n-- Normal performance of backup players (all games, not just when no leader is injured)\nbackup_performance_normal AS (\n    SELECT\n        s.player_id,\n        p.team_id,\n        s.stat_type,\n        s.stat_value AS backup_stats_normal\n    FROM `smartbetting-dados`.`nba`.`int_season_averages_general_base` AS s\n    LEFT JOIN `smartbetting-dados`.`nba`.`stg_active_players` AS p\n        ON s.player_id = p.player_id\n),\n\n-- Base player statistics with odds and rankings\nplayer_base_stats AS (\n    SELECT\n        p.player_id,\n        p.team_id,\n        s.stat_type,\n        s.stat_value,\n        ROW_NUMBER() OVER (\n            PARTITION BY p.team_id, s.stat_type\n            ORDER BY s.stat_value DESC\n        ) AS stat_rank,\n        AVG(s.stat_value) OVER (PARTITION BY p.team_id, s.stat_type) AS team_avg_stat,\n        STDDEV(s.stat_value) OVER (PARTITION BY p.team_id, s.stat_type) AS team_stddev_stat\n    FROM `smartbetting-dados`.`nba`.`stg_active_players` AS p\n    LEFT JOIN `smartbetting-dados`.`nba`.`int_season_averages_general_base` AS s\n        ON p.player_id = s.player_id\n),\n\n-- Calculate z-scores and ratings\nplayer_ratings AS (\n    SELECT\n        *,\n        CASE\n            WHEN team_stddev_stat IS null OR team_stddev_stat = 0 THEN 0\n            ELSE (stat_value - team_avg_stat) / team_stddev_stat\n        END AS zscore,\n        CASE\n            WHEN (stat_value - team_avg_stat) / NULLIF(team_stddev_stat, 0) > 1.67 THEN 3\n            WHEN (stat_value - team_avg_stat) / NULLIF(team_stddev_stat, 0) >= 1 THEN 2\n            WHEN (stat_value - team_avg_stat) / NULLIF(team_stddev_stat, 0) >= 0 THEN 1\n            ELSE 0\n        END AS rating_stars\n    FROM player_base_stats\n),\n\n-- Add injury status information\nplayers_with_injury_status AS (\n    SELECT\n        pr.*,\n        ir.status,\n        COALESCE(pr.stat_rank = 1 AND ir.status IS NOT null, false) AS is_leader_with_injury,\n        COALESCE(pr.stat_rank > 1, false OR ir.status IS null, false) AS is_available_backup\n    FROM player_ratings AS pr\n    LEFT JOIN `smartbetting-dados`.`nba`.`stg_player_injuries` AS ir\n        ON pr.player_id = ir.player_id\n),\n\n-- Identify next available players for each stat (always show next best player)\nnext_available_players AS (\n    SELECT\n        leader.team_id,\n        leader.stat_type,\n        leader.player_id AS current_leader_id,\n        backup.player_id AS next_available_player_id,\n        p.player_name AS next_available_player_name,\n        COALESCE(bpwi.backup_stats_when_leader_out, 0) AS next_player_stats_when_leader_out,\n        COALESCE(bpn.backup_stats_normal, 0) AS next_player_stats_normal\n    FROM players_with_injury_status AS leader\n    LEFT JOIN players_with_injury_status AS backup\n        ON\n            leader.team_id = backup.team_id\n            AND leader.stat_type = backup.stat_type\n            AND backup.is_available_backup = true\n    LEFT JOIN `smartbetting-dados`.`nba`.`stg_active_players` AS p\n        ON backup.player_id = p.player_id\n    LEFT JOIN backup_performance_when_leader_injured AS bpwi\n        ON\n            leader.player_id = bpwi.injured_leader_id\n            AND leader.team_id = bpwi.team_id\n            AND leader.stat_type = bpwi.stat_type\n            AND backup.player_id = bpwi.backup_player_id\n    LEFT JOIN backup_performance_normal AS bpn\n        ON\n            backup.team_id = bpn.team_id\n            AND backup.player_id = bpn.player_id\n            AND backup.stat_type = bpn.stat_type\n    WHERE leader.is_leader_with_injury = true -- Always show next player for the current leader\n    QUALIFY ROW_NUMBER() OVER (\n        PARTITION BY leader.team_id, leader.stat_type\n        ORDER BY backup.stat_rank\n    ) = 1\n)\n\n-- Final result combining all data\n-- Shows next available player info with conditional logic for injury-related stats\nSELECT\n    player_id,\n    team_id,\n    stat_type,\n    rating_stars,\n    is_leader_with_injury,\n    is_available_backup,\n    stat_rank,\n    next_available_player_name,\n    next_player_stats_when_leader_out,\n    next_player_stats_normal,\n    CURRENT_TIMESTAMP() AS loaded_at\nFROM (\n    SELECT\n        pwis.*,\n        -- Always show next available player name and normal stats\n        nap.next_available_player_name,\n        nap.next_player_stats_normal,\n        -- Only show leader_out stats when current player is a leader with injury\n        CASE\n            WHEN pwis.is_leader_with_injury = true THEN nap.next_player_stats_when_leader_out\n        END AS next_player_stats_when_leader_out\n    FROM players_with_injury_status AS pwis\n    LEFT JOIN next_available_players AS nap\n        ON\n            pwis.team_id = nap.team_id\n            AND pwis.stat_type = nap.stat_type\n)\nORDER BY player_id, stat_type", "relation_name": "`smartbetting-dados`.`nba`.`dim_stat_player`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.625842Z", "completed_at": "2026-02-23T12:32:57.647501Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.649640Z", "completed_at": "2026-02-23T12:32:57.649648Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03030848503112793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_nba.not_null_dim_player_shooting_by_zones_player_id.96e06052f2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect player_id\nfrom `smartbetting-dados`.`nba`.`dim_player_shooting_by_zones`\nwhere player_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.634731Z", "completed_at": "2026-02-23T12:32:57.646803Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.649120Z", "completed_at": "2026-02-23T12:32:57.649133Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03166460990905762, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_nba.unique_dim_player_shooting_by_zones_player_id.6aaf061840", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select player_id as unique_field\n  from `smartbetting-dados`.`nba`.`dim_player_shooting_by_zones`\n  where player_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.640661Z", "completed_at": "2026-02-23T12:32:57.648509Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.650669Z", "completed_at": "2026-02-23T12:32:57.650677Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03731513023376465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_nba.not_null_dim_players_player_id.75645f58ed", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect player_id\nfrom `smartbetting-dados`.`nba`.`dim_players`\nwhere player_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.655702Z", "completed_at": "2026-02-23T12:32:57.663155Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.666799Z", "completed_at": "2026-02-23T12:32:57.666808Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.023072481155395508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_nba.unique_dim_players_player_id.186a7aa709", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select player_id as unique_field\n  from `smartbetting-dados`.`nba`.`dim_players`\n  where player_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.667755Z", "completed_at": "2026-02-23T12:32:57.682094Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.683633Z", "completed_at": "2026-02-23T12:32:57.683643Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02532219886779785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_nba.not_null_dim_teams_team_id.b917317b64", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect team_id\nfrom `smartbetting-dados`.`nba`.`dim_teams`\nwhere team_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.677793Z", "completed_at": "2026-02-23T12:32:57.684164Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.685719Z", "completed_at": "2026-02-23T12:32:57.685728Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02398681640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_nba.dbt_utils_unique_combination_of_columns_ft_game_player_stats_player_id__game_id__stat_type.bf9f1fa6ec", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        player_id, game_id, stat_type\n    from `smartbetting-dados`.`nba`.`ft_game_player_stats`\n    group by player_id, game_id, stat_type\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.673815Z", "completed_at": "2026-02-23T12:32:57.684633Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.687794Z", "completed_at": "2026-02-23T12:32:57.687803Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03250288963317871, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_nba.unique_dim_teams_team_id.206fbd4edd", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select team_id as unique_field\n  from `smartbetting-dados`.`nba`.`dim_teams`\n  where team_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.691092Z", "completed_at": "2026-02-23T12:32:57.698646Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.703538Z", "completed_at": "2026-02-23T12:32:57.703547Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.021076679229736328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_nba.not_null_ft_games_game_id.f7b4a5c4bb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect game_id\nfrom `smartbetting-dados`.`nba`.`ft_games`\nwhere game_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.699667Z", "completed_at": "2026-02-23T12:32:57.704801Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.711084Z", "completed_at": "2026-02-23T12:32:57.711095Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016341209411621094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_nba.unique_ft_games_game_id.9354555850", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select game_id as unique_field\n  from `smartbetting-dados`.`nba`.`ft_games`\n  where game_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-23T12:32:57.706855Z", "completed_at": "2026-02-23T12:32:57.713809Z"}, {"name": "execute", "started_at": "2026-02-23T12:32:57.714314Z", "completed_at": "2026-02-23T12:32:57.714321Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.016551733016967773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_nba.dbt_utils_unique_combination_of_columns_dim_stat_player_player_id__stat_type.c9638888a0", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        player_id, stat_type\n    from `smartbetting-dados`.`nba`.`dim_stat_player`\n    group by player_id, stat_type\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 0.7269594669342041, "args": {"use_fast_test_edges": false, "invocation_command": "dbt docs generate --static", "cache_selected_only": false, "quiet": false, "show_all_deprecations": false, "use_colors_file": true, "upload_to_artifacts_ingest_api": false, "introspect": true, "project_dir": "/home/runner/work/analytics-engineering/analytics-engineering/dbt_nba", "source_freshness_run_project_hooks": true, "defer": false, "indirect_selection": "eager", "require_resource_names_without_spaces": true, "require_generic_test_arguments_property": true, "print": true, "version_check": true, "require_yaml_configuration_for_mf_time_spines": false, "macro_debugging": false, "which": "generate", "partial_parse_file_diff": true, "vars": {}, "empty_catalog": false, "state_modified_compare_vars": false, "strict_mode": false, "validate_macro_args": false, "use_colors": true, "static_parser": true, "compile": true, "static": true, "log_file_max_bytes": 10485760, "require_all_warnings_handled_by_warn_error": false, "partial_parse": true, "require_ref_searches_node_package_before_root": false, "profiles_dir": "/home/runner/work/analytics-engineering/analytics-engineering", "log_format_file": "debug", "skip_nodes_if_on_run_start_fails": false, "exclude": [], "log_level_file": "debug", "require_batched_execution_for_custom_microbatch_strategy": false, "require_explicit_package_overrides_for_builtin_materializations": true, "show_resource_report": false, "select": [], "log_format": "default", "favor_state": false, "populate_cache": true, "send_anonymous_usage_stats": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "write_json": true, "require_unique_project_resource_names": false, "printer_width": 80, "state_modified_compare_more_unrendered_values": false, "log_path": "/home/runner/work/analytics-engineering/analytics-engineering/dbt_nba/logs", "require_nested_cumulative_type_params": false, "log_level": "info"}}